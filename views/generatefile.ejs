<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">
    <script src="https://kit.fontawesome.com/81ea002fd8.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="page2.css">
</head>
<body>
    <div class="top">
        <div class="top1">
            <img src="clogo.png">
        </div>
        <div class="top2">
            <p class="top21">You choose, We do it</p>
            <p class="top22">St. Joseph's College of Engineering</p>
            <p class="top23">Department of computer Science & Engineering</p>
        </div>
        <div class="top3">
            <img src="clogo1.PNG" class="top31">
        </div>
    </div>
    <div class="outer">
        <div class="nav">
            <div class="head_section">
              <img src="user.png" alt="">
              <div class="name">
                <h3><%=username%></h3>
              </div>
            </div>
            <div class="nav_links">
                <ul>
                    <li><a href="details"><i class="fas fa-info-circle"></i><span>Staff Details</span></a></li>
                    <li><a href="uploadfile"><i class="fas fa-file-import"></i><span>Upload File</span></a></li>
                    <li><a href="generatefile"><i class="fas fa-file-export"></i><span>Generate File</span></a></li>
                    <li><a href="changepass"><i class="fas fa-key"></i><span>Change Password</span></a></li>
                    <li><a href="logout"><i class="fas fa-sign-out-alt"></i><span>Log Out</span></a></li>
                  </ul>
            </div>
          </div>
          <div class="upload">
              <h3>Generate file</h3>
              <form action="/generate" method="POST">
                <label for="batch">Batch :</label>
                <input type="text" list="batch0" id="batch" autocomplete="off" name="batch" required="required">
                <datalist id="batch0">
                    <option  id="batch1"></option>
                    <option  id="batch2"></option>
                    <option  id="batch3"></option>
                    <option  id="batch4"></option>
                    <option  id="batch5"></option>         
                </datalist>
                <br>
                <label for="sem">Semester :</label>
                <input type="text" id="sem" list="sem0" disabled="disabled" name="semester" autocomplete="off" required="required">
                <datalist id="sem0">
                    <option  id="">Semester 1</option>
                    <option  id="">Semester 2</option>
                    <option  id="">Semester 3</option>
                    <option  id="">Semester 4</option>
                    <option  id="">Semester 5</option>
                    <option  id="">Semester 6</option>
                    <option  id="">Semester 7</option>
                    <option  id="">Semester 8</option>        
                </datalist>
                <br>
                <label for="sub">Subject :</label>
                <input type="text" id="sub" list="sub0" disabled="disabled" name="subject" autocomplete="off" required="required">
                <datalist id="sub0"></datalist>          
                <br> 
                <br>
                <label for="sub">Target :</label>
                <input type="text" id="tar" list="tar" disabled="disabled" name="target" autocomplete="off" required="required">          
                </br>
                <button type="submit" style="margin: 30px 0px 0px 240px">Generate</button>
                <a href="" id="download">File Generated  <i class="fas fa-download"></i></a>
            </form>
          </div>
    </div>   
    <script>
        var y=new Date().getFullYear();
        var st='<%-stat%>';
        var filename='<%-filename%>';
        console.log(filename);
        var filename1=filename.split("#");
        var file1="";
        for(i=1;i<filename1.length-1;i++)
            file1+=filename1[i]+"_";
            
        if(st=="1")
        {
            document.getElementById("download").setAttribute("href","./"+filename);
            console.log("./"+filename);
            document.getElementById("download").setAttribute("download","sam.pdf");
        }    
        if(st=="0")
        document.getElementById("download").setAttribute("class","download12");
        var st1='<%-status%>';
        if(st1=="1")
        window.alert("File Generated");
        var subject='<%-subject%>';
        subject=subject.split(",");
        for(i=0;i<5;i++)
        document.getElementById("batch"+(i+1)).innerHTML=""+(y-i)+"-"+(y-i+4);
        document.getElementById("batch").addEventListener("keyup",function(){
        if(document.getElementById("batch").value.length>3)
        document.getElementById("sem").removeAttribute("disabled");
        if(document.getElementById("batch").value.length<9)
        document.getElementById("sem").setAttribute("disabled","disabled");
        });
        var sem;
        document.getElementById("sem").addEventListener("keyup",function(){
        sem=document.getElementById("sem").value;
        if(document.getElementById("sem").value.length>8)
        document.getElementById("sub").removeAttribute("disabled");
        if(sem=="Semester 1")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester1"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        if(sem=="Semester 2")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester2"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    console.log("passed");
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        if(sem=="Semester 3")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester3"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    console.log("passed");
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        if(sem=="Semester 4")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester4"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    console.log("passed");
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        if(sem=="Semester 5")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester5"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    console.log("passed");
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        if(sem=="Semester 6")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester6"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    console.log("passed");
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        if(sem=="Semester 7")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester7"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    console.log("passed");
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        if(sem=="Semester 8")
        {
            var sub=" ";
            var sem1="";
            for(i=0;i<subject.length;i++)
            {
                
                if(subject[i].split("#")[1]=="Semester8"&&document.getElementById("batch").value==subject[i].split("#")[0])
                {
                    console.log("passed");
                    sem1+=subject[i].split("#")[2]+"#";
                }
            }
           for(j=0;j<sem1.split("#").length;j++)
            {
                sub+=`<option>${sem1.split("#")[j]}</option>`;
            }
            document.getElementById("sub0").innerHTML=""+sub;
        }
        });
    </script>    
</body>
</html>